\documentclass[xcolor=dvipsnames]{beamer}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,slovak]{babel}

\usepackage{amsmath}
\usepackage{amsthm}
\usetheme{Pittsburgh}
\useoutertheme{shadow}

\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}

\usepackage[]{algorithm2e}
\usepackage{listings}
 \setbeamercovered{transparent}
 \usepackage{cuted}
\usepackage[export]{adjustbox}
\usepackage{mathtools}

\usepackage{lipsum}
\usepackage{verbatim}
\usepackage{transparent}
\usepackage{framed}
\usepackage{xcolor}

\usepackage{multirow}
\usepackage{colortbl}
\usepackage{lmodern}

\newcommand\Wider[2][3em]{%
\makebox[\linewidth][c]{%
  \begin{minipage}{\dimexpr\textwidth+#1\relax}
  \raggedright#2
  \end{minipage}%
  }%
}




\iffalse

\usetheme{Warsaw}

\setbeamercolor{normal text}{fg=white,bg=black!90}
\setbeamercolor{structure}{fg=white}

\setbeamercolor{alerted text}{fg=red!85!black}

\setbeamercolor{item projected}{use=item,fg=black,bg=item.fg!35}

\setbeamercolor*{palette primary}{use=structure,fg=structure.fg}
\setbeamercolor*{palette secondary}{use=structure,fg=structure.fg!95!black}
\setbeamercolor*{palette tertiary}{use=structure,fg=structure.fg!90!black}
\setbeamercolor*{palette quaternary}{use=structure,fg=structure.fg!95!black,bg=black!80}

\setbeamercolor*{framesubtitle}{fg=white}

\setbeamercolor*{block title}{parent=structure,bg=black!60}
\setbeamercolor*{block body}{fg=black,bg=black!10}
\setbeamercolor*{block title alerted}{parent=alerted text,bg=black!15}
\setbeamercolor*{block title example}{parent=example text,bg=black!15}

\fi



%-------------------------------------------------------------------------------------
\title{\color{white} \bf Deep learning}
\author{\color{white} Michal CHOVANEC, PhD}


%\setbeamertemplate{footline}[frame number]{}
\setbeamertemplate{navigation symbols}{}


\date[EURP]{}
\begin{document}

{
    \usebackgroundtemplate
    {
        \vbox to \paperheight{\vfil\hbox to \paperwidth{\hfil

        {\includegraphics[width=5.05in]{../../pictures/rl_square.jpg}}

        \hfil}\vfil}
    }
    \begin{frame}

    %\titlepage


    \centering
     \colorbox{black}
     {
        \begin{minipage}{7cm}
           {\LARGE \color{white} \bf Deep learning} \\
           {\LARGE \color{white} Michal CHOVANEC, PhD} \\
       \end{minipage}
     }


    \end{frame}
}

\begin{frame}{\bf Applications}

\begin{itemize}
  \item self driving cars - Tesla model S
  \item healthcare, biomedical engineering - Cell in fluid
  \item voice search, control - Google, Amazon Echo
  \item machine translation - Google translator
  \item image recognition - Huawei Mate 10
  \item game bots, robotics - DeepMind, Boston Dynamics
\end{itemize}

\begin{columns}

    \begin{column}{0.33\textwidth}

      \begin{figure}
        \includegraphics[scale=0.03]{../../pictures/chess.jpg}
      \end{figure}

    \end{column}

    \begin{column}{0.33\textwidth}  %%<--- here

      \begin{figure}
      \includegraphics[scale=0.15]{../../pictures/nvidia_car.jpg}
      \end{figure}

    \end{column}


    \begin{column}{0.33\textwidth}  %%<--- here

        \begin{figure}
        \includegraphics[scale=0.15]{../../pictures/speach_recognition.jpg}
        \end{figure}

    \end{column}

\end{columns}


\begin{figure}
\includegraphics[scale=0.2]{../../pictures/image_recognition.png}
\end{figure}


\end{frame}


\begin{frame}{\bf Deep learning \footnotemark}

  \begin{figure}
    \includegraphics[scale=0.4]{../../pictures/end_to_end_learning.png}
  \end{figure}

\footnotetext[1]{\url {https://medium.com/datamob/clearing-the-buzzwords-in-machine-learning-e395ad73178b}}

\end{frame}


\begin{frame}{\bf Deep learning}

\begin{itemize}
  \item classification
  \item object detection
  \item regression
  \item unsupervised features extraction
  \item reinforcement learning
\end{itemize}


\begin{figure}
\includegraphics[scale=0.1]{../../pictures/dl_vs_ml.png}
\end{figure}

\end{frame}

\begin{frame}{\bf Milestones}

{ \footnotesize
    \begin{itemize}
        \item Specters of past
            \begin{itemize}
                \item vanishing gradient, {\bf solution} : ReLU, Inception, Resnet, DenseNet
                \item overfitting, {\bf solution} : Xavier, L1, L2 regularization, dropout, batch normalisation
                \item computation cost, {\bf solution} : NVIDIA Cuda, sharing weights
            \end{itemize}
        \item ImageNet Classification with Deep ConvolutionalNeural Networks \footnotemark
            \begin{itemize}
                \item 2012, Alex Krizhevsky, 34887 citations
            \end{itemize}
        \item Adam
            \begin{itemize}
                \item 2014, Method for Stochastic Optimization \footnotemark
                \item 2014, VGG net, 3x3 kernels instead of 5x5 \footnotemark
            \end{itemize}
        \item AlphaGO, AlphaZero, AlphaStar \footnotemark
            \begin{itemize}
                \item march 2016, december 2017, januray 2019
            \end{itemize}
    \end{itemize}
}


\footnotetext[2]{\url {https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf}}
\footnotetext[3]{\url {https://arxiv.org/abs/1412.6980}}
\footnotetext[4]{\url {https://medium.com/coinmonks/paper-review-of-vggnet-1st-runner-up-of-ilsvlc-2014-image-classification-d02355543a11}}
\footnotetext[5]{\url {https://deepmind.com/}}

\end{frame}


\begin{frame}{\bf Neural network}

\begin{columns}


    \begin{column}{0.4\textwidth}


    \begin{figure}
      \includegraphics[scale=0.4]{../../diagrams/neuron_model.png}
    \end{figure}

    \end{column}

    \begin{column}{0.5\textwidth}  %%<--- here

    \begin{align*}
     y(X) = f(\sum_{i} X_iW_i + b)
    \end{align*}

    \end{column}

\end{columns}


  \begin{figure}
    \includegraphics[scale=0.3]{../../diagrams/deep_nn.png}
  \end{figure}

\end{frame}

\begin{frame}{\bf Convolutional layer}


\begin{figure}
  \includegraphics[scale=0.8]{../../diagrams/nn/convolution_2d.png}
\end{figure}

\begin{align*}
    Y_{yxl} = \sum_{k}^{in\_depth}\sum_{j}^{kh}\sum_{i}^{kw} X_{k, j+y, i+x}W_{lkji} + b_l
\end{align*}

\end{frame}

\begin{frame}{\bf Deep neural network}

\begin{itemize}
  \item Old methods (before NN) - 2011, 25.8\%
  \item Convolutional, AlexNet - 2012, 16.4\%
  \item Google inception - 2013, 6.7\%
  \item Microsoft ResNet - 2015, 6.1\%
  \item DenseNet - 2018, 5.17\%
\end{itemize}

\begin{itemize}

    \item CNN
    \begin{figure}
      \includegraphics[scale=0.15]{../../diagrams/dnn_conv.png}
    \end{figure}

    \item ResNET
    \begin{figure}
      \includegraphics[scale=0.15]{../../diagrams/dnn_resnet.png}
    \end{figure}

    \item DenseNet
    \begin{figure}
      \includegraphics[scale=0.15]{../../diagrams/dnn_densenet.png}
    \end{figure}

\end{itemize}

\end{frame}




\begin{frame}{\bf My research}

\begin{itemize}
  \item Robotics - hobby
  \item Red blood cells trajectory prediction
  \item Deep reinforcement learning
\end{itemize}

\end{frame}


\begin{frame}{\bf Robotics - line follower}

Curve shape classification

\begin{columns}

    \begin{column}{0.5\textwidth}

    \begin{itemize}
      \item stm32f303 (72MHz), stm32f746 (216MHz)
      \item 8x 500nm line sensors
      \item pololu motors, 1:30
      \item network input : 8 last line sensors results (8x8 matrix)
      \item response 4..5ms
    \end{itemize}

        \begin{figure}
          \includegraphics[scale=0.1]{../../pictures/robot_debug_app.png}
        \end{figure}

    \end{column}

    \begin{column}{0.5\textwidth}  %%<--- here

        \begin{figure}
          \includegraphics[scale=0.18]{../../diagrams/line_following_net.png}
        \end{figure}

        \begin{figure}
          \includegraphics[scale=0.04]{../../pictures/robot_ascender.jpg}
        \end{figure}

    \end{column}

\end{columns}


\end{frame}


\begin{frame}{\bf Red blood cells trajectory prediction}

\begin{itemize}
  \item train DNN to predict RBC trajectory from past
  \item 15 conv layers network (6hours training on GTX1080ti)
  \item input : RBC position + 7 past frames + other cells position
  \item output: RBC predicted velocity
\end{itemize}

\begin{figure}
  \includegraphics[scale=0.1]{../../pictures/rbc_channel.png}
\end{figure}


\begin{figure}
  \includegraphics[scale=0.15]{../../diagrams/cells_prediction_velocity_integration.png}
\end{figure}


\end{frame}


\begin{frame}{\bf Networks}


{\fontsize{5.2}{7}\selectfont

\begin{table}[]
\begin{tabular}{|l|l|l|l|l|l|l|l|l|}
\hline
\textbf{layer} & \textbf{net 0}                 & \textbf{net 1}                                                                 & \textbf{net 2}                                                                      & \textbf{net 3}                                                                      & \textbf{net 4}                                                                      & \textbf{net 5}                                                                      & \textbf{net 6}                                                                      & \textbf{net 7}                                                                      \\ \hline
0              & \cellcolor[HTML]{67FD9A}fc 256 & \cellcolor[HTML]{34CDF9}\begin{tabular}[c]{@{}l@{}}conv \\ 3x3x32\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
1              & \cellcolor[HTML]{67FD9A}fc 64  & \cellcolor[HTML]{67FD9A}fc 64                                                  & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
2              & \cellcolor[HTML]{67FD9A}fc 32  & \cellcolor[HTML]{67FD9A}fc 32                                                  & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
3              & \cellcolor[HTML]{67FD9A}fc 3   & \cellcolor[HTML]{67FD9A}fc 3                                                   & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
4              &                                &                                                                                & \cellcolor[HTML]{34CDF9}conv 1x1x32                                                 & \cellcolor[HTML]{34CDF9}conv 1x1x16                                                 & \cellcolor[HTML]{34CDF9}conv 1x1x32                                                 & \cellcolor[HTML]{34CDF9}conv 1x1x16                                                 & \cellcolor[HTML]{34CDF9}conv 1x1x16                                                 & \cellcolor[HTML]{34CDF9}conv 1x1x32                                                 \\ \hline
5              &                                &                                                                                & \cellcolor[HTML]{67FD9A}fc 3                                                        & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{67FD9A}fc 3                                                        & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
6              &                                &                                                                                &                                                                                     & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} &                                                                                     & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
7              &                                &                                                                                &                                                                                     & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} &                                                                                     & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
8              &                                &                                                                                &                                                                                     & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} &                                                                                     & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
9              &                                &                                                                                &                                                                                     & \cellcolor[HTML]{34CDF9}conv 1x1x32                                                 &                                                                                     & \cellcolor[HTML]{34CDF9}conv 1x1x32                                                 & \cellcolor[HTML]{34CDF9}conv 1x1x16                                                 & \cellcolor[HTML]{34CDF9}conv 1x1x32                                                 \\ \hline
10             &                                &                                                                                &                                                                                     & \cellcolor[HTML]{67FD9A}fc 3                                                        &                                                                                     & \cellcolor[HTML]{67FD9A}fc 3                                                        & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
11             &                                &                                                                                &                                                                                     &                                                                                     &                                                                                     &                                                                                     & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
12             &                                &                                                                                &                                                                                     &                                                                                     &                                                                                     &                                                                                     & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
13             &                                &                                                                                &                                                                                     &                                                                                     &                                                                                     &                                                                                     & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} & \cellcolor[HTML]{FD6864}\begin{tabular}[c]{@{}l@{}}dense conv\\  3x3x8\end{tabular} \\ \hline
14             &                                &                                                                                &                                                                                     &                                                                                     &                                                                                     &                                                                                     & \cellcolor[HTML]{34CDF9}conv 1x1x32                                                 & \cellcolor[HTML]{34CDF9}conv 1x1x64                                                 \\ \hline
15             &                                &                                                                                &                                                                                     &                                                                                     &                                                                                     &                                                                                     & \cellcolor[HTML]{67FD9A}fc 3                                                        & \cellcolor[HTML]{67FD9A}fc 3                                                        \\ \hline
\end{tabular}
\end{table}
}

\end{frame}

\begin{frame}{\bf Results}

\begin{figure}
  \includegraphics[scale=0.25]{../../diagrams/rbc_deep_network_6.png}
\end{figure}

\end{frame}


\begin{frame}{\bf Results}

\begin{table}[]
\begin{tabular}{|l|llll|}
\hline
\textbf{ID} & \multicolumn{1}{c}{}                                                                  & \multicolumn{1}{c}{}                                                                   & \multicolumn{1}{c}{\textbf{total error}}                                             & \multicolumn{1}{c|}{}                                                                            \\ \hline
            & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}mean\\ {[}um{]}\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}sigma\\ {[}um{]}\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}rms\\ {[}um{]}\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}rms \\ relative\\ {[}\%{]}\end{tabular}}} \\ \hline
\textbf{0}  & \multicolumn{1}{l|}{{\color[HTML]{333333} -9.8}}                                      & \multicolumn{1}{l|}{{\color[HTML]{333333} 38.88}}                                      & \multicolumn{1}{l|}{{\color[HTML]{333333} 40.1}}                                     & {\color[HTML]{333333} 7.23}                                                                      \\ \hline
\textbf{1}  & \multicolumn{1}{l|}{{\color[HTML]{FE0000} \textbf{-36.99}}}                           & \multicolumn{1}{l|}{{\color[HTML]{FE0000} \textbf{215.02}}}                            & \multicolumn{1}{l|}{{\color[HTML]{FE0000} \textbf{218.18}}}                          & {\color[HTML]{FE0000} \textbf{39.32}}                                                            \\ \hline
\textbf{2}  & \multicolumn{1}{l|}{{\color[HTML]{333333} -3.85}}                                     & \multicolumn{1}{l|}{{\color[HTML]{333333} 23.11}}                                      & \multicolumn{1}{l|}{{\color[HTML]{333333} 23.43}}                                    & {\color[HTML]{333333} 4.22}                                                                      \\ \hline
\textbf{3}  & \multicolumn{1}{l|}{{\color[HTML]{333333} -0.32}}                                     & \multicolumn{1}{l|}{{\color[HTML]{333333} 16.09}}                                      & \multicolumn{1}{l|}{{\color[HTML]{333333} 16.09}}                                    & {\color[HTML]{333333} 2.9}                                                                       \\ \hline
\textbf{4}  & \multicolumn{1}{l|}{{\color[HTML]{333333} -1.26}}                                     & \multicolumn{1}{l|}{{\color[HTML]{333333} 11.44}}                                      & \multicolumn{1}{l|}{{\color[HTML]{333333} 11.51}}                                    & {\color[HTML]{333333} 2.07}                                                                      \\ \hline
\textbf{5}  & \multicolumn{1}{l|}{{\color[HTML]{32CB00} \textbf{-0.25}}}                            & \multicolumn{1}{l|}{{\color[HTML]{32CB00} \textbf{11.27}}}                             & \multicolumn{1}{l|}{{\color[HTML]{32CB00} \textbf{11.28}}}                           & {\color[HTML]{32CB00} \textbf{2.03}}                                                             \\ \hline
\textbf{6}  & \multicolumn{1}{l|}{{\color[HTML]{333333} -0.85}}                                     & \multicolumn{1}{l|}{{\color[HTML]{333333} 12.26}}                                      & \multicolumn{1}{l|}{{\color[HTML]{333333} 12.29}}                                    & {\color[HTML]{333333} 2.22}                                                                      \\ \hline
\textbf{7}  & \multicolumn{1}{l|}{{\color[HTML]{333333} -1.67}}                                     & \multicolumn{1}{l|}{{\color[HTML]{333333} 11.9}}                                       & \multicolumn{1}{l|}{{\color[HTML]{333333} 12.02}}                                    & {\color[HTML]{333333} 2.17}                                                                      \\ \hline
\end{tabular}
\end{table}

\end{frame}


\begin{frame}{\bf Reinforcement learning}

\begin{itemize}
  \item learn from punishment and rewards
  \item learn to play a game with unknown rules
  \item obtain {\bf state}, $s$
  \item choose {\bf action}, $a$
  \item {\bf execute} action
  \item obtain {\bf reward}, $R$
  \item learn from {\bf experiences}, $Q(s, a) = R + \gamma \max \limits_{\alpha'} Q(s', \alpha')$
\end{itemize}



\begin{columns}
\begin{column}{0.5\textwidth}

\begin{align*}
Q(s, a) \approx \hat{Q}(s, a; w)
\end{align*}

\end{column}
\begin{column}{0.5\textwidth}  %%<--- here
  \begin{figure}
    \includegraphics[scale=0.28]{../../diagrams/rl_mechanism.png}
  \end{figure}
\end{column}
\end{columns}

\end{frame}



\begin{frame}{\bf Dueling deep Q network - DDQN (2016)}

\begin{align*}
  \hat{Q}(s, a; w) = \underset{\bf \color{green} value\ for\ being\ in\ state\ s}{\hat{V}(s; w)} + \underset{\bf \color{red} advantage\ of\ taking\ action\ a\ at\ state\ s}{\hat{A}(s, a; w)}
\end{align*}
to avoid identifiability we substract average value of A truth all actions
\begin{align*}
  \hat{Q}(s, a; w) = \hat{V}(s; w) + \hat{A}(s, a; w) - \frac{1}{N_{\alpha'}} \sum_{\alpha'} \hat{A}(s, \alpha'; w)
\end{align*}

\begin{figure}[!htb]
  \centering
  \includegraphics[scale=0.3]{../../diagrams/dueling_dqn_0.png}
  \label{img:ddqn_principle}
\end{figure}

\end{frame}

\begin{frame}{\bf Dueling deep Q network - DDQN}

using DQN equation

{\footnotesize
\begin{align*}
  \hat{Q}(s, a; w) &= R + \gamma \max \limits_{\alpha'} \hat{Q}(s', \alpha'; w')
\end{align*}
}

we obtain dueling deep Q network equation

{\footnotesize
\begin{align*}
  \hat{Q}(s, a; w)&= R + \gamma \left( \hat{V}(s'; w') + \max \limits_{\alpha'} \hat{A}(s', \alpha'; w') - \frac{1}{N_{\alpha'}} \sum_{\alpha'} \hat{A}(s', \alpha'; w') \right)
\end{align*}
}

and finally the weights update rule

{\tiny

\begin{align*}
  \Delta w = \eta \left( R + \gamma \left( \hat{V}(s'; w') + \max \limits_{\alpha'} \hat{A}(s', \alpha'; w') - \frac{1}{N_{\alpha'}} \sum_{\alpha'} \hat{A}(s', \alpha'; w') \right) - \hat{Q}(s, a; w)\right) \nabla_w \hat{Q}(s, a; w)
\end{align*}
}

\end{frame}

\begin{frame}{\bf Playing GO (October 2017)}


  \begin{columns}
  \begin{column}{0.5\textwidth}

    \begin{figure}[!htb]
      \centering
      \includegraphics[scale=0.18]{../../pictures/go_board.png}
    \end{figure}


  \end{column}
  \begin{column}{0.5\textwidth}  %%<--- here

    \scriptsize
    {
      \begin{itemize}
        \item {\bf supervised training} - train game using Masters games
        \item {\bf reinforcement learning} - let play two networks against each other
      \end{itemize}
    }
  \end{column}
  \end{columns}

\end{frame}

\begin{frame}{\bf Network architecture}
we need to go much deeper for GO
\begin{itemize}
  \item {\bf 27 convolutional layers} \\ 3 blocks with 8 dense conv + 1 conv layer
  \item {\bf input} \\ 4 matrices $19x19$: black stones, white stones, empty fields, active player
  \item {\bf output} \\ recommended moves 19x19 + 1 for pass = 362 outputs

\end{itemize}

  \begin{figure}[!htb]
    \centering
    \includegraphics[scale=0.07]{../../pictures/go_cnn.png}
  \end{figure}

\end{frame}

\begin{frame}{\bf Network architecture}

{\fontsize{8}{6}\selectfont

\begin{table}[]
\begin{tabular}{|c|l|l|}
\hline
\textbf{layer} & \multicolumn{1}{c|}{\textbf{net 3}}       & \multicolumn{1}{c|}{\textbf{net 5}}       \\ \hline
0              & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
1              & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
2              & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
3              & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
4              & \cellcolor[HTML]{38FFF8}conv 1x1x32       & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
5              & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
6              & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
7              & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
8              & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{38FFF8}conv 1x1x56       \\ \hline
9              & \cellcolor[HTML]{38FFF8}conv 1x1x32       & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
10             & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
11             & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
12             & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
13             & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
14             & \cellcolor[HTML]{38FFF8}conv 1x1x32       & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
15             & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
16             & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
17             & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{38FFF8}conv 1x1x56       \\ \hline
18             & \cellcolor[HTML]{FD6864}dense conv 5x5x32 & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
19             & \cellcolor[HTML]{38FFF8}conv 5x5x64       & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
20             & \cellcolor[HTML]{67FD9A}fc 362            & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
21             &                                           & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
22             &                                           & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
23             &                                           & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
24             &                                           & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
25             &                                           & \cellcolor[HTML]{FD6864}dense conv 3x3x32 \\ \hline
26             &                                           & \cellcolor[HTML]{38FFF8}conv 1x1x64       \\ \hline
27             &                                           & \cellcolor[HTML]{67FD9A}fc 362            \\ \hline
\end{tabular}
\end{table}
}


\end{frame}


\begin{frame}{\bf Supervised results}

\begin{figure}[!htb]
  \centering
  \includegraphics[scale=0.22]{../../pictures/moves_success_rate_testing_top5.png}
\end{figure}


\end{frame}

\begin{frame}{\bf Usefull links}

{\tiny
  \begin{thebibliography}{9}
    \bibitem {}CHRISTOPHER  J.C.H. WATKINS : Q-learning \\ \url{http://www.gatsby.ucl.ac.uk/~dayan/papers/cjch.pdf}
    \bibitem {}Richard S. Sutton : Reinforcement Learning: An Introduction \\ \url{https://www.amazon.com/Reinforcement-Learning-Introduction-Adaptive-Computation/dp/0262193981}

    \bibitem {}Google DeepMind : Playing Atari with Deep Reinforcement Learning \\ \url{https://arxiv.org/pdf/1312.5602.pdf}
    \bibitem {}Google DeepMind : Dueling Network Architectures for Deep Reinforcement Learning \\ \url{https://arxiv.org/pdf/1511.06581.pdf}
    \bibitem {}Google DeepMind :Mastering the Game of Go without Human Knowledge \\ \url{https://deepmind.com/documents/119/agz_unformatted\_nature.pdf}

    \bibitem {}Andrej Karpathy : Pong from pixels \\ \url{http://karpathy.github.io/2016/05/31/rl/}
    \bibitem {}Maxim Lapan : Deep reinforcement learning \\ \url{https://www.amazon.com/Practical-Reinforcement-Learning-Maxim-Lapan/dp/1788834240}
    \bibitem {}Mohit Sewak : Practical Convolutional Neural \\ Networks \url{https://www.amazon.com/Practical-Convolutional-Neural-Networks-Implement/dp/1788392302}
    \bibitem {}Densely Connected Convolutional Networks \\ \url{https://arxiv.org/pdf/1608.06993.pdf}
  \end{thebibliography}
}

\end{frame}


\begin{frame}{\bf Q\&A}

\begin{figure}
  \includegraphics[scale=0.25]{../../pictures/me.jpg}
\end{figure}

\centering {
michal chovanec (michal.nand@gmail.com)
\url{www.youtube.com/channel/UCzVvP2ou8v3afNiVrPAHQGg}
}

\centering {
github
\url{https://github.com/michalnand}
}

\end{frame}


\end{document}
